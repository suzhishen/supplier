<odoo>
    <data>
        
        <record id="fast_blank_order_material_requirements_task_tree" model="ir.ui.view">
            <field name="name">fast_blank_order_material_requirements_task_tree</field>
            <field name="model">fast.blank.order.material.requirements.task</field>
            <field name="arch" type="xml">
                <tree create="0" delete="0" duplicate="0" editable="bottom" expand="1"
                    decoration-danger="reality_product_qty==0 or is_close==True"
                    class="fast_blank_order_material_requirements_task_tree_cus_style">
                    <header>
                        <button name="action_create_fast_material_application" type="object" confirm="确认继续操作吗？"
                                class="oe_stat_button" string="生成领料单" groups="fast_order_center.group_fast_blank_order_material_requirements_task_editable"/>
                        <button name="action_close" type="object" confirm="确认继续操作吗？" class="oe_stat_button"
                                string="批量关闭" groups="fast_order_center.group_fast_blank_order_material_requirements_task_editable"/>
                        <button name="action_open" type="object" confirm="确认继续操作吗？" class="oe_stat_button"
                                string="批量打开" groups="fast_order_center.group_fast_blank_order_material_requirements_task_editable"/>
                    </header>
                    <field name="origin"/>
                    <field name="partner_id" options="{'no_create': True, 'no_open': True}"/>
                    <field name="origin_product_tmpl_id" options="{'no_create': True, 'no_open': True}"/>
                    <field name="product_default_code"/>
                    <field name="product_default_name"/>
                    <field name="color_cn_name"/>
                    <field name="product_spec_remark"/>
                    <field name="product_qty" widget="uom_float" options="{'uomField':'uom_po_id'}" sum="total"
                        decoration-bf="1"/>
                    <button name="action_open_fast_blank_order_material_requirements_line_action" type="object"
                            class="oe_stat_button fa fa-eye" title="需求详情"/>
                    <field name="reality_product_qty" widget="uom_float" options="{'uomField':'uom_po_id'}" sum="total"
                        attrs="{'readonly':['|', ('apply_state', '=', 'full'), ('qty_log_order_line', '!=', [])]}"
                        decoration-bf="1"/>
                    <button name="action_open_qty_log_order_line" type="object" class="oe_stat_button fa fa-eye" title="补数详情" attrs="{'invisible':[('qty_log_order_line', '=', [])]}"/>
                    <button name="action_add_reality_product_qty" type="object" class="oe_stat_button fa fa-plus text-danger"
                            string="补数" groups="fast_order_center.group_fast_blank_order_material_requirements_task_editable"
                            attrs="{'invisible':[('apply_state', '!=', 'full')]}"/>
                    <field name="done_apply_qty" widget="uom_float" options="{'uomField':'uom_po_id'}" sum="total"
                        decoration-bf="1"
                        decoration-danger="done_apply_qty==0"
                        decoration-warning="done_apply_qty > 0 and reality_product_qty > done_apply_qty"
                        decoration-success="done_apply_qty > 0 and done_apply_qty >= reality_product_qty"/>
                    <field name="pending_apply_qty" widget="uom_float" options="{'uomField':'uom_po_id'}" sum="total"
                        decoration-bf="1"/>
                    <field name="this_po_occupancy_qty" widget="uom_float" options="{'uomField':'uom_po_id'}"
                        decoration-bf="1"
                        decoration-danger="this_po_occupancy_qty==0"
                        decoration-warning="this_po_occupancy_qty > 0 and reality_product_qty > this_po_occupancy_qty"
                        decoration-success="this_po_occupancy_qty > 0 and this_po_occupancy_qty >= reality_product_qty"/>
                    <button name="action_view_po_fast_inventory_reservation_table_line" type="object"
                            icon="fa-eye text-primary"
                            title="查看本单占用库存" attrs="{'invisible':[('this_po_occupancy_qty', '&lt;=', 0)]}"/>
                    <field name="this_apply_qty" widget="uom_float" options="{'uomField':'uom_po_id'}" sum="total"
                        decoration-bf="1" decoration-danger="this_apply_qty > 0"
                        attrs="{'readonly':['|', ('apply_state', '=', 'full'), '&amp;', '&amp;', ('po_occupancy_can_use_qty', '&lt;=', 0), ('can_use_inventory_qty', '&lt;=', 0), ('this_po_occupancy_qty', '&lt;=', 0)]}"/>
                    <field name="remark" attrs="{'readonly':[('apply_state', '=', 'full')]}"/>
                    <field name="can_use_inventory_qty" widget="uom_float" options="{'uomField':'uom_po_id'}"
                        decoration-bf="1"
                        decoration-danger="can_use_inventory_qty==0"
                        decoration-warning="can_use_inventory_qty > 0 and reality_product_qty > can_use_inventory_qty"
                        decoration-success="can_use_inventory_qty > 0 and can_use_inventory_qty >= reality_product_qty"/>
                    <field name="po_occupancy_can_use_qty" widget="uom_float" options="{'uomField':'uom_po_id'}"
                        decoration-bf="1"
                        decoration-danger="po_occupancy_can_use_qty==0"
                        decoration-warning="po_occupancy_can_use_qty > 0 and reality_product_qty > po_occupancy_can_use_qty"
                        decoration-success="po_occupancy_can_use_qty > 0 and po_occupancy_can_use_qty >= reality_product_qty"/>
                    <button name="action_view_po_fast_inventory_reservation_table_line" type="object"
                            icon="fa-eye text-primary"
                            title="查看PO占用库存" attrs="{'invisible':[('po_occupancy_can_use_qty', '&lt;=', 0)]}"/>
                    <field name="state" widget="badge" decoration-danger="state=='none'" decoration-warning="state=='part'"
                        decoration-success="state=='full'"/>
                    <field name="apply_state" widget="badge" decoration-danger="apply_state=='none'"
                        decoration-warning="apply_state=='part'"
                        decoration-success="apply_state=='full'"/>
                    <field name="body"/>
                    <field name="order_type" widget="badge" optional="show"
                        decoration-primary="order_type=='cut'"
                        decoration-info="order_type=='fob'"
                        decoration-muted="order_type=='mtp'"/>
                    <field name="is_close" optional="show"/>
                    <field name="user_id" options="{'no_create': True, 'no_open': True}" widget="many2one_avatar_user"/>
                    <field name="assist_uom_id" invisible="1"/>
                    <field name="uom_po_id" invisible="1"/>
                    <field name="qty_log_order_line" invisible="1"/>
                </tree>
            </field>
        </record>
        <record id="fast_blank_order_material_requirements_task_action_readonly" model="ir.actions.act_window">
            <field name="name">物料需求-待申领任务表</field>
            <field name="res_model">fast.blank.order.material.requirements.task</field>
            <field name="view_mode">tree</field>
            <field name="context">{'search_default_is_close_false': 1, 'search_default_apply_state_none': 1,
                'search_default_apply_state_part': 1}
            </field>
            <field name="search_view_id" ref="fast_order_center.fast_blank_order_material_requirements_task_search"/>
            <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('fast_blank_order_material_requirements_task_tree_readonly')})]"/>
        </record>
    </data>
</odoo>